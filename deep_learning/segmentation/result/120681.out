running with Ivan deep learning work
SLURM job ID: 120681
dataset: ../../data/project2024/
预训练模型已经存在，无需下载。
预训练模型已经存在，无需下载。
missing_keys:  ['classifier.4.weight', 'classifier.4.bias']
unexpected_keys:  ['aux_classifier.0.weight', 'aux_classifier.1.weight', 'aux_classifier.1.bias', 'aux_classifier.1.running_mean', 'aux_classifier.1.running_var', 'aux_classifier.1.num_batches_tracked']
Task name: deeplab  num_workers: 4
Using device: cuda
Using version: 2.2.1

Device name: Tesla P100-PCIE-16GB
Total memory: 15.8992919921875 GB
Allocated memory: 0.0 GB
Cached memory: 0.0 GB
optimizer name: sgd
Epoch 1/30
----------
  0%|          | 0/275 [00:00<?, ?it/s]  0%|          | 1/275 [00:39<3:01:52, 39.83s/it]  2%|▏         | 5/275 [01:03<49:26, 10.99s/it]    3%|▎         | 9/275 [01:24<34:25,  7.77s/it]  5%|▍         | 13/275 [01:47<30:15,  6.93s/it]  6%|▌         | 17/275 [02:06<26:07,  6.08s/it]  6%|▌         | 17/275 [02:20<26:07,  6.08s/it]  8%|▊         | 21/275 [02:38<28:40,  6.77s/it]  9%|▉         | 25/275 [02:49<22:23,  5.37s/it]  9%|▉         | 25/275 [03:00<22:23,  5.37s/it] 11%|█         | 29/275 [03:11<22:23,  5.46s/it] 11%|█▏        | 31/275 [03:23<22:43,  5.59s/it] 12%|█▏        | 33/275 [03:36<23:01,  5.71s/it] 13%|█▎        | 36/275 [03:42<18:11,  4.57s/it] 14%|█▍        | 39/275 [03:49<15:25,  3.92s/it] 14%|█▍        | 39/275 [04:00<15:25,  3.92s/it] 15%|█▍        | 40/275 [04:31<34:17,  8.76s/it] 16%|█▌        | 44/275 [04:47<26:03,  6.77s/it] 16%|█▌        | 44/275 [05:00<26:03,  6.77s/it] 17%|█▋        | 48/275 [05:11<24:28,  6.47s/it] 19%|█▉        | 52/275 [05:29<21:28,  5.78s/it] 19%|█▉        | 52/275 [05:40<21:28,  5.78s/it] 20%|██        | 56/275 [05:53<21:23,  5.86s/it] 22%|██▏       | 60/275 [06:03<17:10,  4.79s/it] 23%|██▎       | 64/275 [06:19<15:46,  4.48s/it] 23%|██▎       | 64/275 [06:30<15:46,  4.48s/it] 25%|██▍       | 68/275 [06:32<14:10,  4.11s/it] 26%|██▌       | 71/275 [06:45<14:12,  4.18s/it] 27%|██▋       | 75/275 [06:53<11:41,  3.51s/it] 27%|██▋       | 75/275 [07:10<11:41,  3.51s/it] 28%|██▊       | 76/275 [07:12<16:55,  5.10s/it] 29%|██▊       | 79/275 [07:49<23:45,  7.27s/it] 29%|██▉       | 80/275 [07:59<24:41,  7.60s/it] 30%|███       | 83/275 [08:09<19:31,  6.10s/it] 30%|███       | 83/275 [08:20<19:31,  6.10s/it] 31%|███       | 84/275 [08:52<36:29, 11.46s/it] 32%|███▏      | 88/275 [09:25<31:09, 10.00s/it] 33%|███▎      | 92/275 [09:45<24:38,  8.08s/it] 35%|███▍      | 96/275 [09:57<18:37,  6.24s/it] 36%|███▋      | 100/275 [10:08<14:46,  5.06s/it] 38%|███▊      | 104/275 [10:18<12:06,  4.25s/it] 38%|███▊      | 104/275 [10:30<12:06,  4.25s/it] 39%|███▊      | 106/275 [10:30<12:46,  4.54s/it] 39%|███▉      | 107/275 [10:46<16:22,  5.85s/it] 40%|████      | 110/275 [10:51<12:27,  4.53s/it] 40%|████      | 110/275 [11:10<12:27,  4.53s/it] 40%|████      | 111/275 [11:25<23:33,  8.62s/it] 42%|████▏     | 115/275 [12:24<30:08, 11.30s/it] 43%|████▎     | 119/275 [13:02<27:30, 10.58s/it] 45%|████▍     | 123/275 [13:31<23:50,  9.41s/it] 46%|████▌     | 127/275 [13:48<18:58,  7.69s/it] 46%|████▌     | 127/275 [14:00<18:58,  7.69s/it] 48%|████▊     | 131/275 [14:19<18:26,  7.68s/it] 49%|████▉     | 135/275 [14:29<14:08,  6.06s/it] 50%|████▉     | 137/275 [14:35<12:37,  5.49s/it] 50%|████▉     | 137/275 [14:50<12:37,  5.49s/it] 51%|█████     | 139/275 [14:51<13:30,  5.96s/it] 51%|█████▏    | 141/275 [15:07<14:20,  6.42s/it] 53%|█████▎    | 145/275 [15:16<10:28,  4.84s/it] 53%|█████▎    | 145/275 [15:30<10:28,  4.84s/it] 54%|█████▍    | 149/275 [15:33<09:35,  4.57s/it] 54%|█████▍    | 149/275 [15:50<09:35,  4.57s/it] 55%|█████▍    | 150/275 [15:54<13:23,  6.43s/it] 56%|█████▌    | 154/275 [16:17<12:36,  6.25s/it] 57%|█████▋    | 157/275 [16:28<10:40,  5.43s/it] 57%|█████▋    | 157/275 [16:40<10:40,  5.43s/it] 57%|█████▋    | 158/275 [16:56<16:09,  8.28s/it] 59%|█████▉    | 162/275 [17:12<12:17,  6.52s/it] 60%|██████    | 166/275 [17:24<09:22,  5.16s/it] 61%|██████    | 168/275 [17:29<08:16,  4.64s/it] 61%|██████    | 168/275 [17:40<08:16,  4.64s/it] 62%|██████▏   | 170/275 [17:40<08:25,  4.81s/it] 63%|██████▎   | 172/275 [17:45<07:21,  4.29s/it] 63%|██████▎   | 172/275 [18:00<07:21,  4.29s/it] 63%|██████▎   | 174/275 [18:21<13:14,  7.87s/it] 65%|██████▍   | 178/275 [18:51<12:24,  7.68s/it] 66%|██████▌   | 182/275 [19:21<11:50,  7.63s/it] 68%|██████▊   | 186/275 [19:42<10:05,  6.81s/it] 69%|██████▉   | 190/275 [19:54<07:47,  5.50s/it] 69%|██████▉   | 190/275 [20:10<07:47,  5.50s/it] 71%|███████   | 194/275 [20:11<06:55,  5.13s/it] 72%|███████▏  | 198/275 [20:27<06:03,  4.72s/it] 72%|███████▏  | 198/275 [20:40<06:03,  4.72s/it] 73%|███████▎  | 201/275 [20:40<05:41,  4.62s/it] 74%|███████▍  | 203/275 [20:57<06:29,  5.42s/it] 75%|███████▍  | 205/275 [21:04<05:44,  4.93s/it] 75%|███████▍  | 205/275 [21:20<05:44,  4.93s/it] 75%|███████▍  | 206/275 [21:28<08:36,  7.49s/it] 76%|███████▌  | 209/275 [21:37<06:32,  5.95s/it] 77%|███████▋  | 211/275 [21:44<05:36,  5.26s/it] 77%|███████▋  | 213/275 [21:53<05:11,  5.02s/it] 78%|███████▊  | 215/275 [21:59<04:32,  4.54s/it] 78%|███████▊  | 215/275 [22:10<04:32,  4.54s/it] 79%|███████▉  | 218/275 [22:20<05:07,  5.39s/it] 81%|████████  | 222/275 [22:33<04:02,  4.57s/it] 81%|████████  | 222/275 [22:50<04:02,  4.57s/it] 82%|████████▏ | 226/275 [22:57<04:07,  5.06s/it] 84%|████████▎ | 230/275 [23:12<03:28,  4.64s/it] 85%|████████▌ | 234/275 [23:29<03:04,  4.51s/it] 86%|████████▌ | 237/275 [23:35<02:26,  3.86s/it] 86%|████████▌ | 237/275 [23:50<02:26,  3.86s/it] 87%|████████▋ | 238/275 [23:52<03:14,  5.26s/it] 87%|████████▋ | 239/275 [23:58<03:15,  5.44s/it] 88%|████████▊ | 242/275 [24:06<02:23,  4.35s/it] 89%|████████▊ | 244/275 [24:11<02:00,  3.89s/it] 89%|████████▉ | 246/275 [24:16<01:42,  3.52s/it] 90%|█████████ | 248/275 [24:28<01:54,  4.22s/it] 91%|█████████ | 249/275 [24:34<01:55,  4.45s/it] 91%|█████████▏| 251/275 [24:50<02:13,  5.57s/it] 92%|█████████▏| 254/275 [25:36<03:20,  9.54s/it] 94%|█████████▍| 258/275 [26:08<02:32,  8.95s/it] 95%|█████████▌| 262/275 [26:33<01:42,  7.85s/it] 97%|█████████▋| 266/275 [26:57<01:04,  7.19s/it] 98%|█████████▊| 270/275 [27:12<00:30,  6.09s/it]100%|█████████▉| 274/275 [27:22<00:04,  4.87s/it]100%|██████████| 275/275 [27:23<00:00,  5.98s/it]
train Loss: 1.8278 Acc: 72.0503, Memory allocated: 0.82 GB, Max memory allocated: 8.41 GB
train_color_map: dict_keys([0, 32, 11, 46, 12, 27, 48, 24, 52, 42, 19, 39, 49, 50, 7, 29, 56, 2, 30, 38, 25, 54, 15, 41, 26, 17, 51, 1, 34, 36, 58, 31, 8, 59, 37, 28, 13, 35, 5, 6, 16, 57, 53, 43, 21, 14, 23, 45, 44, 18, 10, 9, 33, 22, 40, 55, 4, 20, 47, 3])
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:13<03:13, 13.80s/it] 27%|██▋       | 4/15 [00:54<02:28, 13.51s/it] 53%|█████▎    | 8/15 [01:12<00:56,  8.10s/it] 53%|█████▎    | 8/15 [01:27<00:56,  8.10s/it] 80%|████████  | 12/15 [01:41<00:23,  7.75s/it]100%|██████████| 15/15 [01:42<00:00,  6.86s/it]
val Loss: 1.8736 Acc: 73.2809, Memory allocated: 1.23 GB, Max memory allocated: 3.40 GB
val_color_map: dict_keys([0, 32, 11, 46, 12, 27, 48, 24, 52, 42, 19, 39, 49, 50, 7, 29, 56, 2, 30, 38, 25, 54, 15, 41, 26, 17, 51, 1, 34, 36, 58, 31, 8, 59, 37, 28, 13, 35, 5, 6, 16, 57, 53, 43, 21, 14, 23, 45, 44, 18, 10, 9, 33, 22, 40, 55, 4, 20, 47, 3])
Iou per Class: [tensor(0.7328), nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, tensor(0.), nan, nan, tensor(0.), nan, nan, nan, nan, nan, nan, nan, tensor(0.), nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan], Mean IoU: 0.1832
Saved new best model at epoch 1 with Mean IoU: 0.1832
Traceback (most recent call last):
  File "/home/Student/s4715365/testfolder/comp7840/deep_learning/segmentation/seg.py", line 424, in <module>
    train_model(model, device, 
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Student/s4715365/testfolder/comp7840/deep_learning/segmentation/seg.py", line 265, in train_model
    lr_scheduler.step()
    ^^^^^^^^^^^^^^^^^
AttributeError: module 'torch.optim.lr_scheduler' has no attribute 'step'
srun: error: c4130-2: task 0: Exited with exit code 1
任务失败或异常结束
