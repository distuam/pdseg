running with Ivan deep learning work
SLURM job ID: 121497
dataset: ../../data/project2024/
预训练模型已经存在，无需下载。
预训练模型已经存在，无需下载。
missing_keys:  ['classifier.4.weight', 'classifier.4.bias']
unexpected_keys:  ['aux_classifier.0.weight', 'aux_classifier.1.weight', 'aux_classifier.1.bias', 'aux_classifier.1.running_mean', 'aux_classifier.1.running_var', 'aux_classifier.1.num_batches_tracked']
Task name: deeplab  num_workers: 4  number of classes: 6
Using device: cuda
Using version: 2.2.1

Device name: Tesla P100-PCIE-16GB
Total memory: 15.8992919921875 GB
Allocated memory: 0.0 GB
Cached memory: 0.0 GB
optimizer name: sgd
loss name:  ce
Epoch 1/50
----------
  0%|          | 0/91 [00:00<?, ?it/s]  2%|▏         | 2/91 [00:05<03:55,  2.64s/it]  7%|▋         | 6/91 [00:10<02:25,  1.71s/it] 11%|█         | 10/91 [00:16<02:05,  1.55s/it] 15%|█▌        | 14/91 [00:21<01:53,  1.48s/it] 20%|█▉        | 18/91 [00:27<01:45,  1.45s/it] 24%|██▍       | 22/91 [00:33<01:38,  1.43s/it] 29%|██▊       | 26/91 [00:38<01:31,  1.42s/it] 33%|███▎      | 30/91 [00:44<01:25,  1.41s/it] 37%|███▋      | 34/91 [00:49<01:19,  1.40s/it] 42%|████▏     | 38/91 [00:55<01:14,  1.40s/it] 46%|████▌     | 42/91 [01:00<01:08,  1.40s/it] 51%|█████     | 46/91 [01:06<01:02,  1.40s/it] 55%|█████▍    | 50/91 [01:12<00:57,  1.40s/it] 59%|█████▉    | 54/91 [01:17<00:51,  1.39s/it] 64%|██████▎   | 58/91 [01:23<00:46,  1.39s/it] 68%|██████▊   | 62/91 [01:28<00:40,  1.39s/it] 73%|███████▎  | 66/91 [01:34<00:34,  1.39s/it] 77%|███████▋ Train Loss: 1.615221 Acc: 49.525192, Memory allocated: 0.48 GB, Max memory allocated: 10.40 GB
 | 70/91 [01:39<00:29,  1.39s/it] 81%|████████▏ | 74/91 [01:45<00:23,  1.39s/it] 86%|████████▌ | 78/91 [01:51<00:18,  1.39s/it] 90%|█████████ | 82/91 [01:56<00:12,  1.39s/it] 95%|█████████▍| 86/91 [02:02<00:06,  1.39s/it] 99%|█████████▉| 90/91 [02:07<00:01,  1.39s/it]100%|██████████| 91/91 [02:08<00:00,  1.41s/it]
  0%|          | 0/16 [00:00<?, ?it/s] 56%|█████▋    | 9/16 [00:05<00:04,  1.72it/s]100%|██████████| 16/16 [00:08<00:00,  1.91it/s]
Val Loss: 1.376820 Acc: 75.737107, Memory allocated: 0.83 GB, Max memory allocated: 10.40 GB
Iou per Class: [tensor(0.7946), tensor(0.0019), tensor(0.0249), tensor(0.), tensor(0.), tensor(0.)], Mean IoU: 0.136905, Mean IoU Without Background: 0.005367
Saved new best model at epoch 1 with Mean IoU: 0.136905
Learning rate: 0.0001
Epoch 2/50
----------
  0%|          | 0/91 [00:00<?, ?it/s]  3%|▎         | 3/91 [00:05<02:30,  1.71s/it]  8%|▊         | 7/91 [00:10<02:06,  1.50s/it] 12%|█▏        | 11/91 [00:16<01:55,  1.45s/it] 16%|█▋        | 15/91 [00:21<01:48,  1.43s/it] 21%|██        | 19/91 [00:27<01:41,  1.41s/it] 25%|██▌       | 23/91 [00:33<01:35,  1.41s/it] 30%|██▉       | 27/91 [00:38<01:29,  1.40s/it] 34%|███▍      | 31/91 [00:44<01:24,  1.40s/it] 38%|███▊      | 35/91 [00:49<01:18,  1.40s/it] 43%|████▎     | 39/91 [00:55<01:12,  1.40s/it] 47%|████▋     | 43/91 [01:00<01:07,  1.40s/it] 52%|█████▏    | 47/91 [01:06<01:01,  1.40s/it] 56%|█████▌    | 51/91 [01:12<00:55,  1.40s/it] 60%|██████    | 55/91 [01:17<00:50,  1.40s/it] 65%|██████▍   | 59/91 [01:23<00:44,  1.39s/it] 69%|██████▉   | 63/91 [01:28<00:39,  1.39s/it] 74%|███████▎  | 67/91 [01:34<00:33,  1.39s/it] 78%|███████▊  | 71/91 [01:39<00:27,  1.39s/it] 82%|████████▏ | 75/91 [01:45<00:22,  1.39s/it] 87%|████████▋ | 79/91 [01:51<00:16,  1.39s/it] 91%|█████████ | 83/91 [01:56<00:11,  1.39s/it] 96%|█████████▌| 87/91 [02:02<00:05,  1.39s/it]100%|██████████| 91/91 [02:06<00:00,  1.39s/it]
Train Loss: 1.196278 Acc: 76.801857, Memory allocated: 0.48 GB, Max memory allocated: 10.40 GB
  0%|          | 0/16 [00:00<?, ?it/s] 56%|█████▋    | 9/16 [00:05<00:04,  1.74it/s]100%|██████████| 16/16 [00:08<00:00,  1.92it/s]
Val Loss: 1.013184 Acc: 78.233236, Memory allocated: 0.83 GB, Max memory allocated: 10.40 GB
Iou per Class: [tensor(0.7917), tensor(0.), tensor(0.), tensor(0.), tensor(0.), tensor(0.)], Mean IoU: 0.131946, Mean IoU Without Background: 0.000000
Learning rate: 9.816137691008487e-05
Epoch 3/50
----------
  0%|          | 0/91 [00:00<?, ?it/s]  3%|▎         | 3/91 [00:05<02:31,  1.72s/it]  8%|▊         | 7/91 [00:10<02:06,  1.51s/it] 12%|█▏        | 11/91 [00:16<01:56,  1.45s/it] 16%|█▋        | 15/91 [00:21<01:48,  1.43s/it] 21%|██        | 19/91 [00:27<01:41,  1.42s/it] 25%|██▌       | 23/91 [00:33<01:35,  1.41s/it] 30%|██▉       | 27/91 [00:38<01:29,  1.40s/it] 34%|███▍      | 31/91 [00:44<01:24,  1.40s/it] 38%|███▊      | 35/91 [00:49<01:18,  1.40s/it] 43%|████▎     | 39/91 [00:55<01:12,  1.40s/it] 47%|████▋     | 43/91 [01:00<01:07,  1.40s/it] 52%|█████▏    | 47/91 [01:06<01:01,  1.40s/it] 56%|█████▌    | 51/91 [01:12<00:55,  1.40s/it] 60%|██████    | 55/91 [01:17<00:50,  1.40s/it] 65%|██████▍   | 59/91 [01:23<00:44,  1.40s/it] 69%|██████▉   | 63/91 [01:28<00:39,  1.40s/it] 74%|███████▎  | 67/91 [01:34<00:33,  1.40s/it] 78%|███████▊  | 71/91 [01:40<00:27,  1.40s/it] 82%|████████▏ | 75/91 [01:45<00:22,  1.40s/it] 87%|████████▋ | 79/91 [01:51<00:16,  1.39s/it] 91%|█████████ | 83/91 [01:56<00:11,  1.39s/it] 96%|█████████▌| 87/91 [02:02<00:05,  1.40s/it]100%|██████████| 91/91 [02:06<00:00,  1.40s/it]
Train Loss: 0.977765 Acc: 77.081859, Memory allocated: 0.48 GB, Max memory allocated: 10.40 GB
  0%|          | 0/16 [00:00<?, ?it/s] 56%|█████▋    | 9/16 [00:05<00:04,  1.72it/s]100%|██████████| 16/16 [00:08<00:00,  1.91it/s]
Val Loss: 0.896776 Acc: 78.326389, Memory allocated: 0.83 GB, Max memory allocated: 10.40 GB
Iou per Class: [tensor(0.7959), tensor(0.), tensor(0.), tensor(0.), tensor(0.), tensor(0.)], Mean IoU: 0.132643, Mean IoU Without Background: 0.000000
Learning rate: 9.63189190709574e-05
Epoch 4/50
----------
  0%|          | 0/91 [00:00<?, ?it/s]  3%|▎         | 3/91 [00:05<02:30,  1.71s/it]  8%|▊         | 7/91 [00:10<02:06,  1.50s/it] 12%|█▏        | 11/91 [00:16<01:56,  1.45s/it] 16%|█▋        | 15/91 [00:21<01:48,  1.43s/it] 21%|██        | 19/91 [00:27<01:41,  1.42s/it] 25%|██▌       | 23/91 [00:33<01:35,  1.41s/it] 30%|██▉       | 27/91 [00:38<01:29,  1.40s/it] 34%|███▍      | 31/91 [00:44<01:24,  1.40s/it] 38%|███▊      | 35/91 [00:49<01:18,  1.40s/it] 43%|████▎     | 39/91 [00:55<01:12,  1.40s/it] 47%|████▋     | 43/91 [01:00<01:07,  1.40s/it] 52%|█████▏    | 47/91 [01:06<01:01,  1.40s/it] 56%|█████▌    | 51/91 [01:12<00:55,  1.40s/it] 60%|██████    | 55/91 [01:17<00:50,  1.40s/it] 65%|██████▍   | 59/91 [01:23<00:44,  1.40s/it] 69%|██████▉   | 63/91 [01:28<00:39,  1.40s/it] 74%|███████▎  | 67/91 [01:34<00:33,  1.40s/it] 78%|███████▊  | 71/91 [01:39<00:27,  1.40s/it] 82%|████████▏ | 75/91 [01:45<00:22,  1.40s/it] 87%|████████▋ | 79/91 [01:51<00:16,  1.40s/it] 91%|█████████ | 83/91 [01:56<00:11,  1.40s/it] 96%|█████████▌| 87/91 [02:02<00:05,  1.39s/it]100%|██████████| 91/91 [02:06<00:00,  1.39s/it]
Train Loss: 0.889543 Acc: 77.101609, Memory allocated: 0.48 GB, Max memory allocated: 10.41 GB
  0%|          | 0/16 [00:00<?, ?it/s] 56%|█████▋    | 9/16 [00:05<00:04,  1.68it/s]100%|██████████| 16/16 [00:08<00:00,  1.88it/s]
Val Loss: 0.851127 Acc: 78.132805, Memory allocated: 0.83 GB, Max memory allocated: 10.41 GB
Iou per Class: [tensor(0.8150), tensor(0.), tensor(0.), tensor(0.), tensor(0.), tensor(0.)], Mean IoU: 0.135834, Mean IoU Without Background: 0.000000
Learning rate: 9.447253662418737e-05
Epoch 5/50
----------
  0%|          | 0/91 [00:00<?, ?it/s]  3%|▎         | 3/91 [00:05<02:32,  1.74s/it]  8%|▊         | 7/91 [00:10<02:07,  1.51s/it] 12%|█▏        | 11/91 [00:16<01:56,  1.46s/it] 16%|█▋        | 15/91 [00:21<01:48,  1.43s/it] 21%|██        | 19/91 [00:27<01:42,  1.42s/it] 25%|██▌       | 23/91 [00:33<01:35,  1.41s/it] 30%|██▉       | 27/91 [00:38<01:29,  1.41s/it] 34%|███▍      | 31/91 [00:44<01:24,  1.40s/it] 38%|███▊      | 35/91 [00:49<01:18,  1.40s/it] 43%|████▎     | 39/91 [00:55<01:12,  1.40s/it] 47%|████▋     | 43/91 [01:01<01:07,  1.40s/it] 52%|█████▏    | 47/91 [01:06<01:01,  1.40s/it] 56%|█████▌    | 51/91 [01:12<00:55,  1.40s/it] 60%|██████    | 55/91 [01:17<00:50,  1.40s/it] 65%|██████▍   | 59/91 [01:23<00:44,  1.40s/it] 69%|██████▉   | 63/91 [01:28<00:39,  1.40s/it] 74%|███████▎  | 67/91 [01:34<00:33,  1.40s/it] 78%|███████▊  | 71/91 [01:40<00:27,  1.40s/it] 82%|████████▏ | 75/91 [01:45<00:22,  1.40s/it] 87%|████████▋ | 79/91 [01:51<00:16,  1.40s/it] 91%|█████████ | 83/91 [01:56<00:11,  1.40s/it] 96%|█████████▌| 87/91 [02:02<00:05,  1.40s/it]100%|██████████| 91/91 [02:07<00:00,  1.40s/it]
Train Loss: 0.844244 Acc: 77.147317, Memory allocated: 0.48 GB, Max memory allocated: 10.41 GB
  0%|          | 0/16 [00:00<?, ?it/s] 56%|█████▋    | 9/16 [00:05<00:04,  1.73it/s]100%|██████████| 16/16 [00:08<00:00,  1.92it/s]
Val Loss: 0.808500 Acc: 78.180417, Memory allocated: 0.83 GB, Max memory allocated: 10.41 GB
Iou per Class: [tensor(0.8047), tensor(0.), tensor(0.), tensor(0.), tensor(0.), tensor(0.)], Mean IoU: 0.134118, Mean IoU Without Background: 0.000000
Learning rate: 9.262213560371404e-05
Epoch 6/50
----------
  0%|          | 0/91 [00:00<?, ?it/s]  3%|▎         | 3/91 [00:05<02:29,  1.70s/it]  8%|▊         | 7/91 [00:10<02:05,  1.50s/it] 12%|█▏        | 11/91 [00:16<01:55,  1.45s/it] 16%|█▋        | 15/91 [00:21<01:48,  1.43s/it] 21%|██        | 19/91 [00:27<01:41,  1.42s/it] 25%|██▌       | 23/91 [00:32<01:35,  1.41s/it] 30%|██▉       | 27/91 [00:38<01:29,  1.40s/it] 34%|███▍      | 31/91 [00:44<01:24,  1.40s/it] 38%|███▊      | 35/91 [00:49<01:18,  1.40s/it] 43%|████▎     | 39/91 [00:55<01:12,  1.40s/it] 47%|████▋     | 43/91 [01:00<01:07,  1.40s/it] 52%|█████▏    | 47/91 [01:06<01:01,  1.40s/it] 56%|█████▌    | 51/91 [01:12<00:55,  1.40s/it] 60%|██████    | 55/91 [01:17<00:50,  1.40s/it] 65%|██████▍   | 59/91 [01:23<00:44,  1.40s/it] 69%|██████▉   | 63/91 [01:28<00:39,  1.40s/it] 74%|███████▎  | 67/91 [01:34<00:33,  1.40s/it] 78%|███████▊  | 71/91 [01:39<00:27,  1.40s/it] 82%|████████▏ | 75/91 [01:45<00:22,  1.40s/it] 87%|████████▋ | 79/91 [01:51<00:16,  1.40s/it] 91%|█████████ | 83/91 [01:56<00:11,  1.39s/it] 96%|█████████▌| 87/91 [02:02<00:05,  1.39s/it]100%|██████████| 91/91 [02:06<00:00,  1.39s/it]
Train Loss: 0.804329 Acc: 77.396814, Memory allocated: 0.48 GB, Max memory allocated: 10.41 GB
  0%|          | 0/16 [00:00<?, ?it/s] 56%|█████▋    | 9/16 [00:05<00:04,  1.75it/s]100%|██████████| 16/16 [00:08<00:00,  1.93it/s]
Val Loss: 0.779514 Acc: 78.492397, Memory allocated: 0.83 GB, Max memory allocated: 10.41 GB
Iou per Class: [tensor(0.7947), tensor(0.), tensor(0.), tensor(0.), tensor(0.), tensor(0.)], Mean IoU: 0.132455, Mean IoU Without Background: 0.000000
Learning rate: 9.076761765247331e-05
Epoch 7/50
----------
  0%|          | 0/91 [00:00<?, ?it/s]  3%|▎         | 3/91 [00:05<02:35,  1.77s/it]  8%|▊         | 7/91 [00:10<02:07,  1.52s/it] 12%|█▏        | 11/91 [00:16<01:56,  1.46s/it] 16%|█▋        | 15/91 [00:22<01:49,  1.43s/it] 21%|██        | 19/91 [00:27<01:42,  1.42s/it] 25%|██▌       | 23/91 [00:33<01:35,  1.41s/it] 30%|██▉       | 27/91 [00:38<01:29,  1.41s/it] 34%|███▍      | 31/91 [00:44<01:24,  1.40s/it] 38%|███▊      | 35/91 [00:49<01:18,  1.40s/it] 43%|████▎     | 39/91 [00:55<01:12,  1.40s/it] 47%|████▋     | 43/91 [01:01<01:07,  1.40s/it] 52%|█████▏    | 47/91 [01:06<01:01,  1.40s/it] 56%|█████▌    | 51/91 [01:12<00:55,  1.40s/it] 60%|██████    | 55/91 [01:17<00:50,  1.40s/it] 65%|██████▍   | 59/91 [01:23<00:44,  1.40s/it] 69%|██████▉   | 63/91 [01:29<00:39,  1.40s/it] 74%|███████▎  | 67/91 [01:34<00:33,  1.40s/it] 78%|███████▊  | 71/91 [01:40<00:27,  1.40s/it] 82%|████████▏ | 75/91 [01:45<00:22,  1.40s/it] 87%|████████▋ | 79/91 [01:51<00:16,  1.40s/it] 91%|█████████ | 83/91 [01:56<00:11,  1.39s/it] 96%|█████████▌| 87/91 [02:02<00:05,  1.39s/it]100%|██████████| 91/91 [02:07<00:00,  1.40s/it]
Train Loss: 0.784036 Acc: 77.245648, Memory allocated: 0.48 GB, Max memory allocated: 10.41 GB
  0%|          | 0/16 [00:00<?, ?it/s] 56%|█████▋    | 9/16 [00:05<00:04,  1.72it/s]100%|██████████| 16/16 [00:08<00:00,  1.91it/s]
Val Loss: 0.777784 Acc: 77.896023, Memory allocated: 0.83 GB, Max memory allocated: 10.41 GB
Iou per Class: [tensor(0.8103), tensor(0.), tensor(0.), tensor(0.), tensor(0.), tensor(0.)], Mean IoU: 0.135048, Mean IoU Without Background: 0.000000
Learning rate: 8.890887971257889e-05
Epoch 8/50
----------
  0%|          | 0/91 [00:00<?, ?it/s]  3%|▎         | 3/91 [00:05<02:30,  1.71s/it]  8%|▊         | 7/91 [00:10<02:06,  1.51s/it] 12%|█▏        | 11/91 [00:16<01:56,  1.45s/it] 16%|█▋        | 15/91 [00:21<01:48,  1.43s/it] 21%|██        | 19/91 [00:27<01:41,  1.42s/it] 25%|██▌       | 23/91 [00:33<01:35,  1.41s/it] 30%|██▉       | 27/91 [00:38<01:29,  1.40s/it] 34%|███▍      | 31/91 [00:44<01:24,  1.40s/it] 38%|███▊      | 35/91 [00:49<01:18,  1.40s/it] 43%|████▎     | 39/91 [00:55<01:12,  1.40s/it] 47%|████▋     | 43/91 [01:00<01:07,  1.40s/it] 52%|█████▏    | 47/91 [01:06<01:01,  1.40s/it] 56%|█████▌    | 51/91 [01:12<00:55,  1.40s/it] 60%|██████    | 55/91 [01:17<00:50,  1.40s/it] 65%|██████▍   | 59/91 [01:23<00:44,  1.40s/it] 69%|██████▉   | 63/91 [01:28<00:39,  1.40s/it] 74%|███████▎  | 67/91 [01:34<00:33,  1.40s/it] 78%|███████▊  | 71/91 [01:40<00:27,  1.40s/it] 82%|████████▏ | 75/91 [01:45<00:22,  1.40s/it] 87%|████████▋ | 79/91 [01:51<00:16,  1.40s/it] 91%|█████████ | 83/91 [01:56<00:11,  1.40s/it] 96%|█████████▌| 87/91 [02:02<00:05,  1.39s/it]100%|██████████| 91/91 [02:06<00:00,  1.40s/it]
Train Loss: 0.767367 Acc: 77.353583, Memory allocated: 0.48 GB, Max memory allocated: 10.41 GB
  0%|          | 0/16 [00:00<?, ?it/s] 50%|█████     | 8/16 [00:05<00:05,  1.56it/s]100%|██████████| 16/16 [00:08<00:00,  1.84it/s]
Val Loss: 0.721878 Acc: 79.308715, Memory allocated: 0.83 GB, Max memory allocated: 10.41 GB
Iou per Class: [tensor(0.8191), tensor(0.), tensor(0.), tensor(0.), tensor(0.), tensor(0.)], Mean IoU: 0.136509, Mean IoU Without Background: 0.000000
Learning rate: 8.704581368591593e-05
Epoch 9/50
----------
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** JOB 121497 ON c4130-2 CANCELLED AT 2024-04-28T00:09:38 ***
  0%|          | 0/91 [00:00<?, ?it/s]  3%|▎         | 3/91 [00:05<02:34,  1.76s/it]  8%|▊         | 7/91 [00:10<02:07,  1.52s/it]slurmstepd: error: *** STEP 121497.0 ON c4130-2 CANCELLED AT 2024-04-28T00:09:38 ***
