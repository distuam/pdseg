running with Ivan deep learning work
SLURM job ID: 120682
dataset: ../../data/project2024/
预训练模型已经存在，无需下载。
预训练模型已经存在，无需下载。
missing_keys:  ['classifier.4.weight', 'classifier.4.bias']
unexpected_keys:  ['aux_classifier.0.weight', 'aux_classifier.1.weight', 'aux_classifier.1.bias', 'aux_classifier.1.running_mean', 'aux_classifier.1.running_var', 'aux_classifier.1.num_batches_tracked']
Task name: fcn  num_workers: 4
Using device: cuda
Using version: 2.2.1

Device name: Tesla P100-PCIE-16GB
Total memory: 15.8992919921875 GB
Allocated memory: 0.0 GB
Cached memory: 0.0 GB
optimizer name: sgd
Epoch 1/30
----------
  0%|          | 0/275 [00:00<?, ?it/s]  0%|          | 1/275 [00:44<3:22:11, 44.27s/it]  2%|▏         | 5/275 [01:11<55:27, 12.33s/it]    3%|▎         | 9/275 [01:34<38:46,  8.75s/it]  5%|▍         | 13/275 [01:59<33:34,  7.69s/it]  6%|▌         | 17/275 [02:19<28:34,  6.64s/it]  6%|▌         | 17/275 [02:30<28:34,  6.64s/it]  8%|▊         | 21/275 [02:51<30:05,  7.11s/it]  9%|▉         | 25/275 [03:01<23:09,  5.56s/it]  9%|▉         | 25/275 [03:20<23:09,  5.56s/it] 11%|█         | 29/275 [03:24<22:55,  5.59s/it] 12%|█▏        | 32/275 [03:29<18:44,  4.63s/it] 12%|█▏        | 32/275 [03:40<18:44,  4.63s/it] 12%|█▏        | 33/275 [03:47<24:21,  6.04s/it] 13%|█▎        | 36/275 [03:53<18:55,  4.75s/it] 14%|█▍        | 39/275 [03:59<15:12,  3.87s/it] 14%|█▍        | 39/275 [04:10<15:12,  3.87s/it] 15%|█▍        | 40/275 [04:42<35:05,  8.96s/it] 16%|█▌        | 44/275 [04:58<26:22,  6.85s/it] 16%|█▌        | 44/275 [05:10<26:22,  6.85s/it] 17%|█▋        | 48/275 [05:20<24:13,  6.40s/it] 19%|█▉        | 52/275 [05:38<21:13,  5.71s/it] 19%|█▉        | 52/275 [05:50<21:13,  5.71s/it] 20%|██        | 56/275 [06:03<21:23,  5.86s/it] 22%|██▏       | 60/275 [06:12<16:57,  4.73s/it] 23%|██▎       | 64/275 [06:26<15:21,  4.37s/it] 25%|██▍       | 68/275 [06:39<13:46,  3.99s/it] 25%|██▍       | 68/275 [06:50<13:46,  3.99s/it] 26%|██▌       | 71/275 [06:53<14:12,  4.18s/it] 27%|██▋       | 75/275 [07:03<11:54,  3.57s/it] 27%|██▋       | 75/275 [07:20<11:54,  3.57s/it] 28%|██▊       | 78/275 [07:20<13:37,  4.15s/it] 29%|██▊       | 79/275 [07:59<25:57,  7.95s/it] 29%|██▉       | 81/275 [08:04<21:34,  6.67s/it] 29%|██▉       | 81/275 [08:20<21:34,  6.67s/it] 31%|███       | 84/275 [08:58<33:19, 10.47s/it] 32%|███▏      | 88/275 [09:30<29:40,  9.52s/it] 33%|███▎      | 92/275 [09:50<24:08,  7.91s/it] 35%|███▍      | 96/275 [10:02<18:35,  6.23s/it] 36%|███▋      | 100/275 [10:14<14:59,  5.14s/it] 38%|███▊      | 104/275 [10:23<12:02,  4.22s/it] 38%|███▊      | 104/275 [10:40<12:02,  4.22s/it] 39%|███▉      | 107/275 [10:51<15:31,  5.54s/it] 40%|████      | 110/275 [10:57<12:33,  4.57s/it] 40%|████      | 110/275 [11:10<12:33,  4.57s/it] 40%|████      | 111/275 [11:31<21:40,  7.93s/it] 42%|████▏     | 115/275 [12:31<28:27, 10.67s/it] 43%|████▎     | 119/275 [13:09<26:37, 10.24s/it] 45%|████▍     | 123/275 [13:36<22:57,  9.06s/it] 46%|████▌     | 127/275 [13:53<18:28,  7.49s/it] 46%|████▌     | 127/275 [14:10<18:28,  7.49s/it] 48%|████▊     | 131/275 [14:24<18:17,  7.62s/it] 49%|████▉     | 135/275 [14:35<14:14,  6.10s/it] 49%|████▉     | 135/275 [14:50<14:14,  6.10s/it] 51%|█████     | 139/275 [14:58<13:31,  5.97s/it] 51%|█████▏    | 141/275 [15:11<13:28,  6.03s/it] 53%|█████▎    | 145/275 [15:20<10:23,  4.79s/it] 54%|█████▍    | 149/275 [15:36<09:32,  4.54s/it] 54%|█████▍    | 149/275 [15:50<09:32,  4.54s/it] 55%|█████▍    | 150/275 [15:58<13:11,  6.33s/it] 56%|█████▌    | 154/275 [16:21<12:26,  6.17s/it] 57%|█████▋    | 157/275 [16:33<10:47,  5.49s/it] 57%|█████▋    | 157/275 [16:50<10:47,  5.49s/it] 57%|█████▋    | 158/275 [16:59<15:29,  7.94s/it] 59%|█████▉    | 162/275 [17:15<11:57,  6.35s/it] 60%|██████    | 166/275 [17:26<09:13,  5.08s/it] 60%|██████    | 166/275 [17:40<09:13,  5.08s/it] 62%|██████▏   | 170/275 [17:43<08:19,  4.75s/it] 62%|██████▏   | 170/275 [18:00<08:19,  4.75s/it] 63%|██████▎   | 174/275 [18:24<11:00,  6.54s/it] 65%|██████▍   | 178/275 [18:54<11:03,  6.84s/it] 66%|██████▌   | 182/275 [19:24<10:59,  7.09s/it] 68%|██████▊   | 186/275 [19:45<09:38,  6.50s/it] 69%|██████▉   | 190/275 [19:56<07:35,  5.36s/it] 69%|██████▉   | 190/275 [20:10<07:35,  5.36s/it] 71%|███████   | 194/275 [20:12<06:42,  4.97s/it] 72%|███████▏  | 198/275 [20:28<06:00,  4.68s/it] 72%|███████▏  | 198/275 [20:40<06:00,  4.68s/it] 73%|███████▎  | 201/275 [20:41<05:38,  4.57s/it] 74%|███████▍  | 203/275 [20:58<06:24,  5.34s/it] 75%|███████▍  | 205/275 [21:04<05:37,  4.82s/it] 75%|███████▍  | 205/275 [21:20<05:37,  4.82s/it] 75%|███████▍  | 206/275 [21:29<08:37,  7.50s/it] 76%|███████▌  | 209/275 [21:37<06:20,  5.77s/it] 77%|███████▋  | 212/275 [21:46<04:57,  4.73s/it] 77%|███████▋  | 212/275 [22:00<04:57,  4.73s/it] 78%|███████▊  | 214/275 [22:00<05:28,  5.39s/it] 79%|███████▉  | 217/275 [22:06<04:02,  4.18s/it] 79%|███████▉  | 217/275 [22:20<04:02,  4.18s/it] 79%|███████▉  | 218/275 [22:21<05:27,  5.74s/it] 81%|████████  | 222/275 [22:35<04:10,  4.74s/it] 81%|████████  | 222/275 [22:50<04:10,  4.74s/it] 82%|████████▏ | 226/275 [22:59<04:15,  5.21s/it] 84%|████████▎ | 230/275 [23:14<03:30,  4.68s/it] 84%|████████▎ | 230/275 [23:30<03:30,  4.68s/it] 85%|████████▌ | 234/275 [23:31<03:04,  4.50s/it] 85%|████████▌ | 234/275 [23:50<03:04,  4.50s/it] 87%|████████▋ | 238/275 [23:54<03:02,  4.92s/it] 87%|████████▋ | 239/275 [23:59<02:57,  4.94s/it] 88%|████████▊ | 242/275 [24:06<02:18,  4.19s/it] 89%|████████▊ | 244/275 [24:12<01:59,  3.87s/it] 89%|████████▉ | 246/275 [24:18<01:45,  3.64s/it] 90%|█████████ | 248/275 [24:29<01:51,  4.14s/it] 91%|█████████▏| 251/275 [24:51<02:06,  5.28s/it] 92%|█████████▏| 254/275 [25:33<02:53,  8.26s/it] 94%|█████████▍| 258/275 [26:03<02:15,  7.98s/it] 95%|█████████▌| 262/275 [26:25<01:31,  7.02s/it] 97%|█████████▋| 266/275 [26:47<00:58,  6.53s/it] 98%|█████████▊| 270/275 [27:02<00:28,  5.65s/it] 99%|█████████▉| 273/275 [27:07<00:09,  4.63s/it]100%|██████████| 275/275 [27:13<00:00,  5.94s/it]
train Loss: 1.8449 Acc: 71.7270, Memory allocated: 0.75 GB, Max memory allocated: 7.56 GB
train_color_map: dict_keys([0, 20, 58, 17, 56, 16, 11, 25, 42, 50, 12, 18, 55, 8, 37, 2, 40, 23, 5, 54, 34, 7, 46, 27, 33, 22, 15, 39, 4, 51, 3, 30, 26, 47, 43, 36, 29, 41, 48, 21, 6, 19, 57, 45, 52, 49, 38, 31, 24, 13, 32, 14, 28, 53, 10, 44, 59, 1, 35, 9])
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:14<03:18, 14.15s/it] 27%|██▋       | 4/15 [00:52<02:23, 13.03s/it] 53%|█████▎    | 8/15 [01:09<00:53,  7.70s/it] 53%|█████▎    | 8/15 [01:26<00:53,  7.70s/it] 80%|████████  | 12/15 [01:37<00:22,  7.36s/it]100%|██████████| 15/15 [01:38<00:00,  6.55s/it]
val Loss: 1.8245 Acc: 74.1738, Memory allocated: 1.15 GB, Max memory allocated: 10.24 GB
val_color_map: dict_keys([0, 20, 58, 17, 56, 16, 11, 25, 42, 50, 12, 18, 55, 8, 37, 2, 40, 23, 5, 54, 34, 7, 46, 27, 33, 22, 15, 39, 4, 51, 3, 30, 26, 47, 43, 36, 29, 41, 48, 21, 6, 19, 57, 45, 52, 49, 38, 31, 24, 13, 32, 14, 28, 53, 10, 44, 59, 1, 35, 9])
Iou per Class: [tensor(0.7417), nan, tensor(0.), nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, tensor(0.), nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, tensor(0.), nan, nan, nan], Mean IoU: 0.1854
Saved new best model at epoch 1 with Mean IoU: 0.1854
Traceback (most recent call last):
  File "/home/Student/s4715365/testfolder/comp7840/deep_learning/segmentation/seg.py", line 424, in <module>
    train_model(model, device, 
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Student/s4715365/testfolder/comp7840/deep_learning/segmentation/seg.py", line 265, in train_model
    lr_scheduler.step()
    ^^^^^^^^^^^^^^^^^
AttributeError: module 'torch.optim.lr_scheduler' has no attribute 'step'
srun: error: c4130-2: task 0: Exited with exit code 1
任务失败或异常结束
