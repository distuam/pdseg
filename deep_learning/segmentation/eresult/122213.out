running with Ivan deep learning work
SLURM job ID: 122213
dataset: ../../data/project2024/
预训练模型已经存在，无需下载。
预训练模型已经存在，无需下载。
missing_keys:  ['classifier.4.weight', 'classifier.4.bias']
unexpected_keys:  ['aux_classifier.0.weight', 'aux_classifier.1.weight', 'aux_classifier.1.bias', 'aux_classifier.1.running_mean', 'aux_classifier.1.running_var', 'aux_classifier.1.num_batches_tracked']
Task name: fcn  num_workers: 4  number of classes: 6
Using device: cuda
Using version: 2.2.1

Device name: Tesla P100-PCIE-16GB
Total memory: 15.8992919921875 GB
Allocated memory: 0.0 GB
Cached memory: 0.0 GB
optimizer name: sgd
loss name:  ce
Epoch 1/200
----------
  0%|          | 0/67 [00:00<?, ?it/s]  3%|▎         | 2/67 [00:05<02:52,  2.66s/it]  9%|▉         | 6/67 [00:10<01:43,  1.70s/it] 15%|█▍        | 10/67 [00:16<01:27,  1.53s/it] 21%|██        | 14/67 [00:21<01:17,  1.46s/it] 27%|██▋       | 18/67 [00:27<01:09,  1.42s/it] 33%|███▎      | 22/67 [00:32<01:03,  1.40s/it] 39%|███▉      | 26/67 [00:38<00:57,  1.39s/it] 45%|████▍     | 30/67 [00:43<00:51,  1.38s/it] 51%|█████     | 34/67 [00:49<00:45,  1.38s/it] 57%|█████▋    | 38/67 [00:54<00:39,  1.38s/it] 63%|██████▎   | 42/67 [00:59<00:34,  1.37s/it] 69%|██████▊   | 46/67 [01:05<00:28,  1.37s/it] 75%|███████▍  | 50/67 [01:10<00:23,  1.37s/it] 81%|████████  | 54/67 [01:16<00:17,  1.37s/it] 87%|████████▋ | 58/67 [01:21<00:12,  1.37s/it] 93%|█████████▎| 62/67 [01:27<00:06,  1.37s/it] 99%|█████████▊| 66/67 [01:32<00:01,  1.37s/it]100%|██████████| 67/67 [01:33<00:00,  1.39s/it]
Train Loss: 1.517586 Acc: 69.989342, Memory allocated: 0.42 GB, Max memory allocated: 13.17 GB
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:02<00:00,  1.75it/s]
tensor(8860084) tensor(11006830) tensor(8867571) tensor(10999343)
tensor(0) tensor(317158) tensor(316959) tensor(199)
tensor(63) tensor(1066300) tensor(1065928) tensor(435)
tensor(0) tensor(42114) tensor(35135) tensor(6979)
tensor(0) tensor(371935) tensor(371405) tensor(530)
tensor(0) tensor(355612) tensor(353050) tensor(2562)
Val Loss: 1.319536 Acc: 80.473282, Memory allocated: 0.70 GB, Max memory allocated: 13.17 GB
Iou per Class: [tensor(0.8050), tensor(0.), tensor(5.9083e-05), tensor(0.), tensor(0.), tensor(0.)], Mean IoU: 0.134170, Mean IoU Without Background: 0.000012
Traceback (most recent call last):
  File "/home/Student/s4715365/testfolder/comp7840/deep_learning/segmentation/seg.py", line 124, in <module>
    train_model(model=model, 
    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Student/s4715365/testfolder/comp7840/deep_learning/segmentation/../../deep_learning/segmentation/train.py", line 254, in train_model
    find_best, iou, loss = evaluate(device=device, 
                           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Student/s4715365/testfolder/comp7840/deep_learning/segmentation/../../deep_learning/segmentation/train.py", line 195, in evaluate
    if epoch_loss < best_loss:
                    ^^^^^^^^^
UnboundLocalError: cannot access local variable 'best_loss' where it is not associated with a value
srun: error: c4130-2: task 0: Exited with exit code 1
任务失败或异常结束
