running with Ivan deep learning work
SLURM job ID: 122224
dataset: ../../data/project2024/
预训练模型已经存在，无需下载。
预训练模型已经存在，无需下载。
missing_keys:  ['classifier.4.weight', 'classifier.4.bias']
unexpected_keys:  ['aux_classifier.0.weight', 'aux_classifier.1.weight', 'aux_classifier.1.bias', 'aux_classifier.1.running_mean', 'aux_classifier.1.running_var', 'aux_classifier.1.num_batches_tracked']
Task name: fcn  num_workers: 4  number of classes: 30 , train set ratio: 0.95
Using device: cuda
Using version: 2.2.1

Device name: Tesla P100-PCIE-16GB
Total memory: 15.8992919921875 GB
Allocated memory: 0.0 GB
Cached memory: 0.0 GB
optimizer name: sgd
loss name:  ce
Epoch 1/200
----------
  0%|          | 0/350 [00:00<?, ?it/s]  1%|          | 2/350 [00:05<16:17,  2.81s/it]  2%|▏         | 6/350 [00:11<10:08,  1.77s/it]  3%|▎         | 10/350 [00:16<08:57,  1.58s/it]  4%|▍         | 14/350 [00:22<08:26,  1.51s/it]  5%|▌         | 18/350 [00:28<08:07,  1.47s/it]  6%|▋         | 22/350 [00:33<07:54,  1.45s/it]  7%|▋         | 26/350 [00:39<07:44,  1.43s/it]  9%|▊         | 30/350 [00:44<07:36,  1.43s/it] 10%|▉         | 34/350 [00:50<07:28,  1.42s/it] 11%|█         | 38/350 [00:56<07:22,  1.42s/it] 12%|█▏        | 42/350 [01:01<07:15,  1.41s/it] 13%|█▎        | 46/350 [01:07<07:09,  1.41s/it] 14%|█▍        | 50/350 [01:13<07:03,  1.41s/it] 15%|█▌        | 54/350 [01:18<06:57,  1.41s/it] 17%|█▋        | 58/350 [01:24<06:52,  1.41s/it] 18%|█▊        | 62/350 [01:30<06:46,  1.41s/it] 19%|█▉        | 66/350 [01:35<06:40,  1.41s/it] 20%|██        | 70/350 [01:41<06:34,  1.41s/it] 21%|██        | 74/350 [01:46<06:29,  1.41s/it] 22%|██▏       | 78/350 [01:52<06:23,  1.41s/it] 23%|██▎       | 82/350 [01:58<06:17,  1.41s/it] 25%|██▍       | 86/350 [02:03<06:12,  1.41s/it] 26%|██▌       | 90/350 [02:09<06:06,  1.41s/it] 27%|██▋       | 94/350 [02:15<06:00,  1.41s/it] 28%|██▊       | 98/350 [02:20<05:55,  1.41s/it] 29%|██▉       | 102/350 [02:26<05:49,  1.41s/it] 30%|███       | 106/350 [02:32<05:44,  1.41s/it] 31%|███▏      | 110/350 [02:37<05:38,  1.41s/it] 33%|███▎      | 114/350 [02:43<05:32,  1.41s/it] 34%|███▎      | 118/350 [02:49<05:27,  1.41s/it] 35%|███▍      | 122/350 [02:54<05:21,  1.41s/it] 36%|███▌      | 126/350 [03:00<05:15,  1.41s/it] 37%|███▋      | 130/350 [03:05<05:10,  1.41s/it] 38%|███▊      | 134/350 [03:11<05:04,  1.41s/it] 39%|███▉      | 138/350 [03:17<04:59,  1.41s/it] 41%|████      | 142/350 [03:22<04:53,  1.41s/it] 42%|████▏     | 146/350 [03:28<04:47,  1.41s/it] 43%|████▎     | 150/350 [03:34<04:42,  1.41s/it] 44%|████▍     | 154/350 [03:39<04:36,  1.41s/it] 45%|████▌     | 158/350 [03:45<04:30,  1.41s/it] 46%|████▋     | 162/350 [03:51<04:25,  1.41s/it] 47%|████▋     | 166/350 [03:56<04:19,  1.41s/it] 49%|████▊     | 170/350 [04:02<04:13,  1.41s/it] 50%|████▉     | 174/350 [04:08<04:08,  1.41s/it] 51%|█████     | 178/350 [04:13<04:02,  1.41s/it] 52%|█████▏    | 182/350 [04:19<03:57,  1.41s/it] 53%|█████▎    | 186/350 [04:24<03:51,  1.41s/it] 54%|█████▍    | 190/350 [04:30<03:45,  1.41s/it] 55%|█████▌    | 194/350 [04:36<03:40,  1.41s/it] 57%|█████▋    | 198/350 [04:41<03:34,  1.41s/it] 58%|█████▊    | 202/350 [04:47<03:28,  1.41s/it] 59%|█████▉    | 206/350 [04:53<03:23,  1.41s/it] 60%|██████    | 210/350 [04:58<03:17,  1.41s/it] 61%|██████    | 214/350 [05:04<03:11,  1.41s/it] 62%|██████▏   | 218/350 [05:10<03:06,  1.41s/it] 63%|██████▎   | 222/350 [05:15<03:00,  1.41s/it] 65%|██████▍   | 226/350 [05:21<02:54,  1.41s/it] 66%|██████▌   | 230/350 [05:27<02:49,  1.41s/it] 67%|██████▋   | 234/350 [05:32<02:43,  1.41s/it] 68%|██████▊   | 238/350 [05:38<02:37,  1.41s/it] 69%|██████▉   | 242/350 [05:43<02:32,  1.41s/it] 70%|███████   | 246/350 [05:49<02:26,  1.41s/it] 71%|███████▏  | 250/350 [05:55<02:21,  1.41s/it] 73%|███████▎  | 254/350 [06:00<02:15,  1.41s/it] 74%|███████▎  | 258/350 [06:06<02:09,  1.41s/it] 75%|███████▍  | 262/350 [06:12<02:04,  1.41s/it] 76%|███████▌  | 266/350 [06:17<01:58,  1.41s/it] 77%|███████▋  | 270/350 [06:23<01:52,  1.41s/it] 78%|███████▊  | 274/350 [06:29<01:47,  1.41s/it] 79%|███████▉  | 278/350 [06:34<01:41,  1.41s/it] 81%|████████  | 282/350 [06:40<01:35,  1.41s/it] 82%|████████▏ | 286/350 [06:46<01:30,  1.41s/it] 83%|████████▎ | 290/350 [06:51<01:24,  1.41s/it] 84%|████████▍ | 294/350 [06:57<01:19,  1.41s/it] 85%|████████▌ | 298/350 [07:02<01:13,  1.41s/it] 86%|████████▋ | 302/350 [07:08<01:07,  1.41s/it] 87%|████████▋ | 306/350 [07:14<01:02,  1.41s/it] 89%|████████▊ | 310/350 [07:19<00:56,  1.41s/it] 90%|████████▉ | 314/350 [07:25<00:50,  1.41s/it] 91%|█████████ | 318/350 [07:31<00:45,  1.41s/it] 92%|█████████▏| 322/350 [07:36<00:39,  1.41s/it] 93%|█████████▎| 326/350 [07:42<00:33,  1.41s/it] 94%|█████████▍| 330/350 [07:48<00:28,  1.41s/it] 95%|█████████▌| 334/350 [07:53<00:22,  1.41s/it] 97%|█████████▋| 338/350 [07:59<00:16,  1.41s/it] 98%|█████████▊| 342/350 [08:05<00:11,  1.41s/it] 99%|█████████▉| 346/350 [08:10<00:05,  1.41s/it]100%|██████████| 350/350 [08:16<00:00,  1.40s/it]100%|██████████| 350/350 [08:16<00:00,  1.42s/it]
Train Loss: 2.694210 Acc: 55.231547, Memory allocated: 0.78 GB, Max memory allocated: 13.45 GB
  0%|          | 0/19 [00:00<?, ?it/s] 53%|█████▎    | 10/19 [00:05<00:04,  1.88it/s]100%|██████████| 19/19 [00:09<00:00,  2.07it/s]
tensor(45396921) tensor(58195968) tensor(45396921) tensor(58195968)
tensor(0) tensor(319254) tensor(319254) tensor(0)
tensor(0) tensor(1335934) tensor(1335934) tensor(0)
tensor(0) tensor(184445) tensor(184445) tensor(0)
tensor(0) tensor(523652) tensor(523652) tensor(0)
tensor(0) tensor(938492) tensor(938492) tensor(0)
tensor(0) tensor(590082) tensor(590082) tensor(0)
tensor(0) tensor(605599) tensor(605599) tensor(0)
tensor(0) tensor(173679) tensor(173679) tensor(0)
tensor(0) tensor(0) tensor(0) tensor(0)
Traceback (most recent call last):
  File "/home/Student/s4715365/testfolder/comp7840/deep_learning/segmentation/seg.py", line 124, in <module>
    train_model(model=model, 
    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Student/s4715365/testfolder/comp7840/deep_learning/segmentation/../../deep_learning/segmentation/train.py", line 256, in train_model
    find_best, iou, loss = evaluate(device=device, 
                           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Student/s4715365/testfolder/comp7840/deep_learning/segmentation/../../deep_learning/segmentation/train.py", line 190, in evaluate
    iou = calculate_iou(labels = all_labels, preds = all_preds, num_classes = num_classes, epoch = epoch)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Student/s4715365/testfolder/comp7840/deep_learning/segmentation/../../performance.py", line 67, in calculate_iou
    raise ValueError("union == 0")
ValueError: union == 0
srun: error: c4130-2: task 0: Exited with exit code 1
任务失败或异常结束
